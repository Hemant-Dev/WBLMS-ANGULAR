<div class="col-sm-12">
  <app-leaves-remaining-dashboard
    [userSessionObj]="initialUserSessionObj"
  ></app-leaves-remaining-dashboard>
</div>

<!-- Table 1 -->
<div class="card my-4" *ngIf="role !== 'Admin'">
  <p-table
    #dt2
    [value]="selfLeaveRequests"
    dataKey="id"
    [rows]="pageSize"
    [rowsPerPageOptions]="[2, 4, 10]"
    [paginator]="true"
    [globalFilterFields]="[
      'name',
      'country.name',
      'representative.name',
      'status'
    ]"
    [tableStyle]="{ 'min-width': '70rem' }"
  >
    <ng-template pTemplate="caption">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <p-header>Created Leave Requests</p-header>
        <div class="input-group w-50">
          <input type="text"    [(ngModel)]="seachKeyword" (ngModelChange) ="handleSearch()" name="searchKeyword"  class="form-control mr-2" placeholder="Search" />
          <button class="btn btn-primary mx-3">
            <i class="fa fa-search"></i>
          </button>
          <button
            class="btn btn-primary"
            data-bs-toggle="modal"
            data-bs-target="#addLeaveRequestModal"
          >
            <i class="fa fa-plus"></i>
            Apply Leave
          </button>
        </div>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th>Leaves Type</th>
        <th>Reason</th>
        <th>Status</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th>Number Of Days</th>
        <th>Request Date</th>
        <th>Approved Date</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-request>
      <tr>
        <td>{{ request.leaveType }}</td>
        <td>{{ request.reason }}</td>
        <td>
          <!-- {{ request.status }} -->
          <p-tag [value]="request.status" />
        </td>
        <td>{{ request.startDate }}</td>
        <td>{{ request.endDate }}</td>
        <td>{{ request.numberOfLeaveDays }}</td>
        <td>{{ request.requestDate }}</td>
        <td
          *ngIf="request.approvedDate !== '0001-01-01'; else elseApprovedDate"
        >
          {{ request.approvedDate }}
        </td>
        <ng-template #elseApprovedDate>
          <td>Not Approved</td>
        </ng-template>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="12">No Leave Requests found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<!-- Modal -->
<div
  class="modal fade mt-5"
  id="addLeaveRequestModal"
  tabindex="-1"
  aria-labelledby="addLeaveRequestModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <app-leave-request
      (submitLeaveRequestClicked)="ngOnInit()"
    ></app-leave-request>
  </div>
</div>
